---
title: "Spring Gateway 手册 *"
date: 2021-12-11T16:22:00+08:00
draft: false
author: "Sunny"
---

## 路由

### 路由优先级

对于网关应用来说，有两种路由：

1. 应用内部 Controller 的路由。
2. 路由表中的路由。

要特别注意的是，内部 Controller 的优先级比路由表高，只有当所有 Controller 的路由都没有匹配到才会去匹配路由表中的路由。

尤其要注意，如果 Controller 中定义了 "/" 路由，那么在路由表中的 "/**" 是不会生效的（严格说来，这应该是 Spring Gateway 的一个缺陷，我使用的版本是 2.2.9.RELEASE，切记切记）。

### 路由规则优先级

在路由表的路由模型中，有一个排序属性（order）来控制路由的优先级。当一个请求匹配上多条路由时，会选择权重最高的那条路。order 的值越小，优先级越高。如果 order 值一样，则看路由加载的顺序。

### 路由模型详解

路由模型有以下核心属性：

- id 唯一标识：区分不同的路由规则。
- predicates 断言器列表：断言此路由与请求是否匹配。
- order 优先级：优先级高的路由会优先匹配（值越小，越优先）。
- filters 过滤器列表：对请求进行加工和处理。
- uri 目标服务：上游服务，实际处理请求的服务。

